---
const pathname = Astro.url.pathname;
const base = import.meta.env.BASE_URL;

// A little helper to handle the homepage path correctly, which sometimes has a trailing slash
const homePath = base.endsWith("/") ? base : base + "/";
---

<header
  x-data="{ isOpen: false }"
  @keydown.escape.window="isOpen = false"
  class="relative bg-gradient-to-r from-[#36454F] via-[#3D4E5A] to-[#36454F] shadow-lg"
  style="box-shadow: 0 4px 20px rgba(192, 178, 131, 0.15), inset 0 -1px 0 rgba(192, 178, 131, 0.3);"
>
  <div class="container mx-auto px-6 py-4">
    <div class="flex flex-wrap items-center justify-between">
      <a href="/" class="flex items-center gap-3 group">
        <img
          src="/logo.png"
          alt="SomaRenew Medical Logo"
          class="h-12 w-auto transition-transform duration-300 group-hover:scale-105"
        />
      </a>

      <nav class="hidden lg:flex items-center gap-6 xl:gap-8">
        <a
          class="text-sm xl:text-base font-medium text-white/90 hover:text-[var(--soma-gold)] transition-colors duration-300"
          href="/">Home</a
        >
        <a
          class="text-sm xl:text-base font-medium text-white/90 hover:text-[var(--soma-gold)] transition-colors duration-300"
          href="/aboutus">About Us</a
        >
        <a
          class="text-sm xl:text-base font-medium text-white/90 hover:text-[var(--soma-gold)] transition-colors duration-300"
          href="/services">Services</a
        >
        <a
          class="text-sm xl:text-base font-medium text-white/90 hover:text-[var(--soma-gold)] transition-colors duration-300 whitespace-nowrap"
          href="/patientjourney">The Patient Journey</a
        >
        <a
          class="text-sm xl:text-base font-medium text-white/90 hover:text-[var(--soma-gold)] transition-colors duration-300"
          href="/contact">Contact Us</a
        >
      </nav>
      <div class="hidden lg:flex items-center gap-2 xl:gap-3">
        <a
          class="inline-flex items-center gap-2 rounded-full border border-[var(--soma-gold)]/50 px-4 xl:px-5 py-2 xl:py-2.5 text-sm font-medium text-[var(--soma-gold)] transition-all duration-300 hover:bg-[var(--soma-gold)]/10 hover:border-[var(--soma-gold)]"
          href="#"
        >
          <svg
            class="w-4 h-4"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
            ></path>
          </svg>
          Patient Portal
        </a>
        <a
          class="inline-flex items-center gap-2 rounded-full bg-[var(--soma-gold)] px-5 xl:px-7 py-2.5 xl:py-3 text-sm xl:text-base font-semibold text-[var(--charcoal)] transition-all duration-300 hover:bg-[#D4C89A] hover:scale-105 shadow-md whitespace-nowrap"
          href="/consultation"
        >
          Schedule Consultation
          <svg
            class="w-4 h-4"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
            ><path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M17 8l4 4m0 0l-4 4m4-4H3"></path></svg
          >
        </a>
      </div>

      <button
        @click="isOpen = !isOpen"
        class="lg:hidden p-3 rounded-xl text-white hover:bg-[var(--soma-gold)]/20 hover:text-[var(--soma-gold)] transition-colors"
        :class="{ 'bg-[var(--soma-gold)]/20 text-[var(--soma-gold)]': isOpen }"
        aria-label="Toggle mobile menu"
      >
        <svg
          x-show="!isOpen"
          class="w-6 h-6"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
        <svg
          x-show="isOpen"
          x-cloak
          class="w-6 h-6"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>
    </div>

    <!-- Mobile Menu -->
    <nav
      x-show="isOpen"
      @click.away="isOpen = false"
      class="w-full lg:hidden"
      x-transition:enter="transition ease-out duration-300"
      x-transition:enter-start="opacity-0 -translate-y-4"
      x-transition:enter-end="opacity-100 translate-y-0"
      x-transition:leave="transition ease-in duration-200"
      x-transition:leave-start="opacity-100 translate-y-0"
      x-transition:leave-end="opacity-0 -translate-y-4"
    >
      <div
        class="flex flex-col items-center gap-2 py-6 border-t border-[var(--soma-gold)]/20 mt-4 bg-[var(--warm-white)]"
      >
        <a
          class:list={[
            "text-lg font-medium py-3 min-h-[48px] flex items-center transition-colors",
            {
              "text-[var(--soma-gold)]":
                pathname === base || pathname === homePath,
              "text-[var(--charcoal)] hover:text-[var(--soma-gold)]": !(
                pathname === base || pathname === homePath
              ),
            },
          ]}
          href="/">Home</a
        >
        <a
          class:list={[
            "text-lg font-medium py-3 min-h-[48px] flex items-center transition-colors",
            {
              "text-[var(--soma-gold)]": pathname.startsWith(`${base}/aboutus`),
              "text-[var(--charcoal)] hover:text-[var(--soma-gold)]":
                !pathname.startsWith(`${base}/aboutus`),
            },
          ]}
          href="/aboutus">About Us</a
        >
        <a
          class:list={[
            "text-lg font-medium py-3 min-h-[48px] flex items-center transition-colors",
            {
              "text-[var(--soma-gold)]": pathname.startsWith(
                `${base}/services`,
              ),
              "text-[var(--charcoal)] hover:text-[var(--soma-gold)]":
                !pathname.startsWith(`${base}/services`),
            },
          ]}
          href="/services">Services</a
        >
        <a
          class:list={[
            "text-lg font-medium py-3 min-h-[48px] flex items-center transition-colors",
            {
              "text-[var(--soma-gold)]": pathname.startsWith(
                `${base}/patientjourney`,
              ),
              "text-[var(--charcoal)] hover:text-[var(--soma-gold)]":
                !pathname.startsWith(`${base}/patientjourney`),
            },
          ]}
          href="/patientjourney">The Patient Journey</a
        >
        <a
          class:list={[
            "text-lg font-medium py-3 min-h-[48px] flex items-center transition-colors",
            {
              "text-[var(--soma-gold)]": pathname.startsWith(`${base}/contact`),
              "text-[var(--charcoal)] hover:text-[var(--soma-gold)]":
                !pathname.startsWith(`${base}/contact`),
            },
          ]}
          href="/contact">Contact Us</a
        >
        <a
          class="mt-4 w-full max-w-xs rounded-full border border-[var(--charcoal)]/20 px-6 py-3.5 min-h-[48px] text-center font-medium text-[var(--charcoal)] transition-all duration-300 hover:border-[var(--soma-gold)] hover:text-[var(--soma-gold)]"
          href="#"
        >
          Patient Portal
        </a>
        <a
          class="w-full max-w-xs rounded-full bg-[var(--soma-gold)] px-6 py-3.5 min-h-[48px] text-center font-semibold text-[var(--charcoal)] transition-all duration-300 hover:bg-[#D4C89A]"
          href="/consultation"
        >
          Schedule Consultation
        </a>
      </div>
    </nav>
  </div>
</header>
