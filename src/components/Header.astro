---
const pathname = Astro.url.pathname;
const base = import.meta.env.BASE_URL;

// A little helper to handle the homepage path correctly, which sometimes has a trailing slash
const homePath = base.endsWith('/') ? base : base + '/';
---
<header x-data="{ isOpen: false }" @keydown.escape.window="isOpen = false" class="sticky top-0 z-50 bg-[var(--background)]/80 backdrop-blur-sm">
  <div class="container mx-auto px-6 py-4">
    <div class="flex flex-wrap items-center justify-between">
      <a class="flex items-center gap-3 text-2xl font-bold text-[var(--primary-text)]" href={base}>
        <svg class="h-8 w-8 text-[var(--accent-gold)]" fill="none" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
          <path d="M24 4C25.7818 14.2173 33.7827 22.2182 44 24C33.7827 25.7818 25.7818 33.7827 24 44C22.2182 33.7827 14.2173 25.7818 4 24C14.2173 22.2182 22.2182 14.2173 24 4Z" fill="#C0B283"></path>
        </svg>
        <span class="font-serif">SomaRenew Medical</span>
      </a>
      
      <nav class="hidden md:flex items-center gap-8">
        <a class:list={["nav-link text-lg", { "font-bold text-[var(--accent-gold)]": pathname === base || pathname === homePath }]} href={base}>Home</a>
        <a class:list={["nav-link text-lg", { "font-bold text-[var(--accent-gold)]": pathname.startsWith(`${base}/aboutus`) }]} href=`${base}/aboutus`>About Us</a>
        <a class:list={["nav-link text-lg", { "font-bold text-[var(--accent-gold)]": pathname.startsWith(`${base}/services`) }]} href=`${base}/services`>Services</a>
        <a class:list={["nav-link text-lg", { "font-bold text-[var(--accent-gold)]": pathname.startsWith(`${base}/patientjourney`) }]} href=`${base}/patientjourney`>The Patient Journey</a>
        <a class:list={["nav-link text-lg", { "font-bold text-[var(--accent-gold)]": pathname.startsWith(`${base}/contact`) }]} href=`${base}/contact`>Contact Us</a>
      </nav>
      <a class="btn-primary hidden md:inline-block rounded-full px-8 py-3 text-lg font-semibold tracking-wide" href=`${base}/consultation`>Schedule My Consultation</a>
      
      <button @click="isOpen = !isOpen" class="md:hidden text-3xl text-[var(--primary-text)]">
        â˜°
      </button>
    </div>

    <nav x-show="isOpen" @click.away="isOpen = false" class="w-full md:hidden" x-transition>
      <div class="flex flex-col items-center gap-4 py-8">
        <a class:list={["nav-link text-lg", { "font-bold text-[var(--accent-gold)]": pathname === base || pathname === homePath }]} href={base}>Home</a>
        <a class:list={["nav-link text-lg", { "font-bold text-[var(--accent-gold)]": pathname.startsWith(`${base}/aboutus`) }]} href=`${base}/aboutus`>About Us</a>
        <a class:list={["nav-link text-lg", { "font-bold text-[var(--accent-gold)]": pathname.startsWith(`${base}/services`) }]} href=`${base}/services`>Services</a>
        <a class:list={["nav-link text-lg", { "font-bold text-[var(--accent-gold)]": pathname.startsWith(`${base}/patientjourney`) }]} href=`${base}/patientjourney`>The Patient Journey</a>
        <a class:list={["nav-link text-lg", { "font-bold text-[var(--accent-gold)]": pathname.startsWith(`${base}/contact`) }]} href=`${base}/contact`>Contact Us</a>
      </div>
    </nav>
  </div>
</header>